if (self.CavalryLogger) { CavalryLogger.start_js(["8S1Qz"]); }

__d("PhotoViewState",["ArbiterMixin","PhotoStore","PhotoUtils","SpotlightViewerLoggingEvents","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g;a=babelHelpers.inherits(h,b("mixin")(b("ArbiterMixin")));g=a&&a.prototype;function h(a,b,c){"use strict";__p&&__p();g.constructor.call(this);c=c||{};this._viewer=a;this._setID=b;this._position=c.position||0;this._preventPreload=c.preventPreload;this._reverse=c.reverse;this._updateCallback=c.updateCallback;this._preloaded={}}h.prototype._fetchCallback=function(a){"use strict";if(!this._viewer.isOpen())return;this._preload(a);this._log(b("SpotlightViewerLoggingEvents").DATA_FETCH_COMPLETE)};h.prototype._preload=function(a){"use strict";b("PhotoUtils").preload(this._viewer,a,function(a){this._preloaded[b("PhotoUtils").getFBIDFromData(a)]=!0}.bind(this))};h.prototype._preloadPhotosInRange=function(a,c){"use strict";var d=[];for(var a=a;a<=c;++a){var e=b("PhotoStore").getByIndexImmediate(this._setID,a);e&&!this._isPreloaded(e)&&d.push(e)}this._preload(d)};h.prototype._isPreloaded=function(a){"use strict";return this._preloaded[b("PhotoUtils").getFBIDFromData(a)]};h.prototype.getPosition=function(){"use strict";return this._position};h.prototype.isValidMovement=function(a){"use strict";if(!b("PhotoStore").hasBeenCreated(this._setID))return!1;if(b("PhotoStore").hasLooped(this._setID))return!0;a=this._position+a;var c=b("PhotoStore").getAvailableRange(this._setID),d=c.offset+c.length-1;return a>=c.offset-1&&a<=d+1};h.prototype.getRelativeMovement=function(a){"use strict";return b("PhotoStore").getIndexForID(this._setID,a)-this._position};h.prototype.moveCursor=function(a){"use strict";if(!this.isValidMovement(a))return!1;this._position+=a;return!0};h.prototype._page=function(a){"use strict";if(!this.moveCursor(a))return;this._log(b("SpotlightViewerLoggingEvents").PAGE_BEGIN);var c=b("PhotoStore").getByIndexImmediate(this._setID,this._position);!c?(this.inform("photo_fetch"),this._log(b("SpotlightViewerLoggingEvents").PHOTO_FETCH)):this._isPreloaded(c)||this._preload([c]);b("PhotoStore").getByIndex(this._setID,this._position,this._updateCallback);this._loadMoreIfNecessary(a>0,h.BUFFER_SIZE);this._log(b("SpotlightViewerLoggingEvents").PAGE_COMPLETE)};h.prototype.loadMoreForwardIfNecessary=function(a){"use strict";__p&&__p();if(this._preventPreload)return;var c=b("PhotoStore").getAvailableRange(this._setID);c=c.offset+c.length-1;var d=this._position+a;if(d>c&&!b("PhotoStore").hasLooped(this._setID)){c=b("PhotoStore").getCursorByIndexImmediate(this._setID,c);b("PhotoStore").fetchForward(this._setID,c,a,this._fetchCallback.bind(this))}else this._preloadPhotosInRange(this._position+1,d)};h.prototype.loadMoreBackwardIfNecessary=function(a){"use strict";if(this._preventPreload)return;var c=b("PhotoStore").getAvailableRange(this._setID),d=this._position-a;if(d<c.offset&&!b("PhotoStore").hasLooped(this._setID)){c=b("PhotoStore").getCursorByIndexImmediate(this._setID,c.offset);b("PhotoStore").fetchBackward(this._setID,c,a,this._fetchCallback.bind(this))}else this._preloadPhotosInRange(d,this._position-1)};h.prototype._loadMoreIfNecessary=function(a,b){"use strict";a?this.loadMoreForwardIfNecessary(b):this.loadMoreBackwardIfNecessary(b)};h.prototype.displayFirst=function(){"use strict";if(!this._viewer.isOpen())return;b("PhotoStore").setPreFetchCallback(this._setID,function(){this._log(b("SpotlightViewerLoggingEvents").DATA_FETCH_BEGIN)}.bind(this));var a=function(a){this._isPreloaded(a)||this._preload([a]),this._updateCallback&&this._updateCallback(a)}.bind(this);b("PhotoStore").getByIndex(this._setID,this._position,a);this._reverse?this.loadMoreBackwardIfNecessary(h.BUFFER_SIZE):this.loadMoreForwardIfNecessary(h.BUFFER_SIZE)};h.prototype.backward=function(){"use strict";this._page(this._reverse?1:-1)};h.prototype.forward=function(){"use strict";this._page(this._reverse?-1:1)};h.prototype._log=function(a){"use strict";this._viewer.log(a)};Object.assign(h,{BUFFER_SIZE:4});e.exports=h}),null);
__d("SpotlightViewerClose",["cx","fbt","React","TooltipLink.react","emptyFunction","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){"use strict";var a=this.props.position=="left"?"_5wx3":"_5wx4",c=b("React").createElement("span",null,h._("Press Esc to close"));return b("React").createElement(b("TooltipLink.react"),{className:b("joinClasses")("_4-o9 _50-m _51an",a,this.props.isFixed?"_2chv":""),onClick:this.props.onClick,onKeyPress:this.props.onKeyPress,tooltip:c,tabIndex:"0"})};function a(){"use strict";i.apply(this,arguments)}a.propTypes={position:c.oneOf(["left","right"]),isFixed:c.bool,onKeyPress:c.func};a.defaultProps={position:"right",isFixed:!1,onKeyPress:b("emptyFunction")};e.exports=a}),null);
__d("SpotlightViewerCoreMixin",["PhotoLogger","PhotoStore","PhotoUtils","PhotoViewState","React","SpotlightViewerImage","SpotlightViewerLoggingEvents"],(function(a,b,c,d,e,f){__p&&__p();a={_displayFirstPhoto:function(){b("PhotoStore").executePostCreate(this.props.setid,this.viewState.displayFirst.bind(this.viewState))},_getInitialPosition:function(){var a;this.props.clearcache||(a=b("PhotoStore").getIndexForID(this.props.setid,this.props.photoid));a===undefined&&(b("PhotoStore").clearSetCache(this.props.setid),a=0);return a},__displayPhoto:function(){var a=this._getInitialPosition();this.viewState=new(b("PhotoViewState"))(this,this.props.setid,{position:a,preventPreload:this.__shouldPreventPhotoPreload,reverse:this.props.reverse,updateCallback:this._updatePhoto});this.inform("open");this._displayFirstPhoto()},UNSAFE_componentWillMount:function(){this._logger=new(b("PhotoLogger"))(this.getViewerID()),this.log(b("SpotlightViewerLoggingEvents").OPEN_BEGIN),this.__displayPhoto()},componentDidMount:function(){this._enableSubscriptions&&this._enableSubscriptions(),this.log(b("SpotlightViewerLoggingEvents").OPEN_COMPLETE)},isOpen:function(){return this.state.open},close:function(){if(!this.isOpen())return;this.log(b("SpotlightViewerLoggingEvents").CLOSE_BEGIN);this.setState({open:!1},function(){this.inform("close"),this.log(b("SpotlightViewerLoggingEvents").CLOSE_COMPLETE)})},componentWillUnmount:function(){this.viewState=null},_onClickViewport:function(a){a?this.viewState.forward():this.viewState.backward()},_getMedia:function(a,c){return b("React").createElement(b("SpotlightViewerImage"),{ref:"image",src:a.uri,dimensions:c.imageDimensions})},_getCurrentFBID:function(){return b("PhotoUtils").getFBIDFromData(this.state.photoData)},_updatePhoto:function(a){this.log(b("SpotlightViewerLoggingEvents").PHOTO_CHANGE_BEGIN),this.setState({photoData:a},function(){this.inform("photo_change",this.state.photoData),this.log(b("SpotlightViewerLoggingEvents").PHOTO_CHANGE_COMPLETE)})},getLogger:function(){return this._logger},log:function(a){this._logger&&this._logger.logEvent(a)}};e.exports=a}),null);
__d("QuestionPollType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHOOSE_ONE:"CHOOSE_ONE",CHOOSE_MULTIPLE:"CHOOSE_MULTIPLE",GIF_CHOOSE_ONE:"GIF_CHOOSE_ONE",IMAGE_CHOOSE_ONE:"IMAGE_CHOOSE_ONE",VISUAL_TEXT_CHOOSE_ONE:"VISUAL_TEXT_CHOOSE_ONE",IMAGE_CHOOSE_MULTIPLE:"IMAGE_CHOOSE_MULTIPLE"})}),null);